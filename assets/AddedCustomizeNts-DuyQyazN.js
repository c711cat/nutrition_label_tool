import{M as w,D as L}from"./DoubleCheckModal-D03_2ovZ.js";import{g as b,m as _,_ as v,o as n,c as r,a as t,t as f,B as E,z as m,C as y,d as u,D as c,f as h,F as U,h as V,b as g,n as D,r as k}from"./index-p188OfOp.js";import{a as x,u as M,b as z}from"./component-functions-C1boh6Xt.js";import"./selector-engine-BAtv4zJi.js";const I={data(){return{modal:null,enName:"",chName:"",unit:"公克(g)",type:"以上皆非",localMyAddedNtsList:[],editIndex:"",editEnName:"",editChName:""}},watch:{myAddedNtsList:{handler(){this.getMyAddedNtsList()},deep:!0,immediate:!0}},computed:{...b(x,["myAddedNtsList"]),...b(M,["headerChineseAndEnglish"]),titleText(){let d="";return this.editIndex===""&&(d="新增營養素"),this.editIndex!==""&&(d="編輯營養素"),d}},methods:{..._(z,["openAlert","pushMsg"]),submitForm(d){const e=d.target;if(e.checkValidity())this.submitCustomizeNts();else{e.classList.add("was-validated"),this.openAlert(!0,"還有必填欄位喔！");return}},alreadlyHaveEnName(d){const e=d.target.value;this.localMyAddedNtsList.forEach(a=>{a.enName===e&&this.editEnName!==e&&(this.openAlert(!0,"『 "+e+" 』已存在！"),this.enName="")}),Object.keys(this.headerChineseAndEnglish).forEach(a=>{a.replace(/\(.*\)/,"")===e&&(this.openAlert(!0,"『 "+e+" 』已存在內建資料庫！"),this.enName="")})},alreadlyHaveChName(d){const e=d.target.value;this.localMyAddedNtsList.forEach(a=>{a.chName===e&&this.editChName!==e&&(this.openAlert(!0,"『 "+e+" 』已存在！"),this.chName="")}),Object.values(this.headerChineseAndEnglish).forEach(a=>{a.replace(/\(.*\)/,"")===e&&(this.openAlert(!0,"『 "+e+" 』已存在內建資料庫！"),this.chName="")})},showModal(d,e){e?(this.type=e.type,this.enName=e.enName,this.chName=e.chName,this.unit=e.unit,this.editIndex=d,this.editEnName=e.enName,this.editChName=e.chName):(this.enName="",this.chName="",this.unit="公克(g)",this.type="以上皆非"),this.modal.show()},hideModal(){this.modal.hide()},submitCustomizeNts(){this.editIndex!==""&&(this.localMyAddedNtsList.splice(1,this.editIndex),setTimeout(()=>{this.editIndex=""},1e3)),this.addNt(),this.hideModal()},addNt(){const d={type:this.type,enName:this.enName,chName:this.chName,unit:this.unit,quantity:""};this.localMyAddedNtsList.push(d),localStorage.setItem("myAddedNts",JSON.stringify(this.localMyAddedNtsList));const e={};this.editIndex===""?e.title=this.enName+"："+this.chName+" 新增成功":e.title=this.enName+"："+this.chName+" 修改成功",e.style="success",this.pushMsg(e),setTimeout(()=>{this.enName="",this.chName="",this.unit="公克(g)",this.type="以上皆非"},1e3)},getMyAddedNtsList(){this.localMyAddedNtsList=this.myAddedNtsList||[]}},created(){this.getMyAddedNtsList()},mounted(){this.modal=new w(this.$refs.newClaimNtsModal)}},S={ref:"newClaimNtsModal",class:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},T={class:"modal-dialog modal-dialog-scrollable modal-dialog-centered"},B={class:"modal-content"},F={class:"modal-header bg-primary text-white","data-bs-theme":"dark"},H={class:"modal-title"},j={class:"modal-body"},q={class:"form-floating mb-3"},O={class:"form-floating mb-3"},R={class:"mt-2 ms-2 mb-3"},P={class:"form-check form-check-inline"},J={class:"form-check form-check-inline"},G={class:"form-check form-check-inline"},K={class:"mt-2 ms-2 mb-3"},Q={class:"form-check form-check-inline"},W={class:"form-check form-check-inline"},X={class:"form-check form-check-inline"},Y={class:"form-check form-check-inline"};function Z(d,e,a,p,i,s){return n(),r("div",S,[t("div",T,[t("div",B,[t("div",F,[t("h5",H,f(s.titleText),1),e[12]||(e[12]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",j,[t("form",{id:"submitCustomizeNts",onSubmit:e[11]||(e[11]=E((...l)=>s.submitForm&&s.submitForm(...l),["prevent"])),novalidate:""},[t("div",q,[m(t("input",{onChange:e[0]||(e[0]=l=>s.alreadlyHaveEnName(l)),"onUpdate:modelValue":e[1]||(e[1]=l=>i.enName=l),type:"text",class:"form-control",id:"enName",placeholder:"營養素『 英文 』名稱 或 縮寫",required:""},null,544),[[y,i.enName,void 0,{trim:!0}]]),e[13]||(e[13]=t("div",{class:"invalid-feedback"},"此欄位為必填",-1)),e[14]||(e[14]=t("label",{for:"enName"},[t("i",{class:"text-danger fst-normal"},"＊"),u(" 營養素『 英文 』名稱 或 縮寫 ")],-1))]),t("div",O,[m(t("input",{onChange:e[2]||(e[2]=l=>s.alreadlyHaveChName(l)),"onUpdate:modelValue":e[3]||(e[3]=l=>i.chName=l),type:"text",class:"form-control",id:"chName",placeholder:"營養素『 中文 』名稱",required:""},null,544),[[y,i.chName,void 0,{trim:!0}]]),e[15]||(e[15]=t("div",{class:"invalid-feedback"},"此欄位為必填",-1)),e[16]||(e[16]=t("label",{for:"chName"},[t("i",{class:"text-danger fst-normal"},"＊"),u(" 營養素『 中文 』名稱 ")],-1))]),t("div",R,[e[20]||(e[20]=t("p",{class:"mb-2 fw-bold"},[t("i",{class:"text-danger fst-normal me-1"},"＊"),u(" 營養素單位 ")],-1)),t("div",P,[m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>i.unit=l),class:"form-check-input",type:"radio",id:"gram",value:"公克(g)"},null,512),[[c,i.unit]]),e[17]||(e[17]=t("label",{class:"form-check-label",for:"gram"},"公克 (g)",-1))]),t("div",J,[m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>i.unit=l),class:"form-check-input",type:"radio",id:"milligram",value:"毫克(mg)"},null,512),[[c,i.unit]]),e[18]||(e[18]=t("label",{class:"form-check-label",for:"milligram"}," 毫克 (mg) ",-1))]),t("div",G,[m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>i.unit=l),class:"form-check-input",type:"radio",id:"microgram",value:"微克(ug)"},null,512),[[c,i.unit]]),e[19]||(e[19]=t("label",{class:"form-check-label",for:"microgram"}," 微克 (ug) ",-1))])]),t("div",K,[e[25]||(e[25]=t("p",{class:"mb-2 fw-bold"},[t("i",{class:"text-danger fst-normal me-1"},"＊"),u(" 營養素類別 "),t("i",{class:"bi bi-info-circle ms-2 me-1 text-secondary"}),t("span",{class:"text-secondary fw-normal"}," 以下選擇與熱量計算有關 ")],-1)),t("div",Q,[m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>i.type=l),class:"form-check-input",type:"radio",id:"fiber",value:"膳食纖維"},null,512),[[c,i.type]]),e[21]||(e[21]=t("label",{class:"form-check-label",for:"fiber"},"膳食纖維",-1))]),t("div",W,[m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>i.type=l),class:"form-check-input",type:"radio",id:"sugar_alcohol",value:"糖醇"},null,512),[[c,i.type]]),e[22]||(e[22]=t("label",{class:"form-check-label",for:"sugar_alcohol"}," 糖醇 ",-1))]),t("div",X,[m(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>i.type=l),class:"form-check-input",type:"radio",id:"organic_acid",value:"有機酸"},null,512),[[c,i.type]]),e[23]||(e[23]=t("label",{class:"form-check-label",for:"organic_acid"}," 有機酸 ",-1))]),t("div",Y,[m(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>i.type=l),class:"form-check-input",type:"radio",id:"none",value:"以上皆非"},null,512),[[c,i.type]]),e[24]||(e[24]=t("label",{class:"form-check-label",for:"none"},"以上皆非",-1))])])],32)]),e[26]||(e[26]=t("div",{class:"modal-footer bg-light"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 "),t("button",{form:"submitCustomizeNts",type:"submit",class:"btn btn-primary"}," 送出 ")],-1))])])],512)}const $=v(I,[["render",Z]]),ee={data(){return{}},components:{NewClaimNtsModal:$,DoubleCheckModal:L},computed:{...b(M,["onlyNewAddHeader","myProductList"]),...b(x,["customizeDataList","myAddedNtsList","filteredMyAddedNtsList"]),noResultText(){return this.myAddedNtsList.length===0&&this.filteredMyAddedNtsList.length===0?"目前無新增的營養素～":this.myAddedNtsList.length===0&&this.filteredMyAddedNtsList.length>0?"搜尋結果：無符合的營養素～":""}},methods:{openAddNtsModal(){this.$refs.newClaimNtsModal.showModal()},openEditModal(d,e){this.$refs.newClaimNtsModal.showModal(d,e)},openDoubleCheckModal(d,e){this.$refs.doubleCheckModal.showDelAddedNtModal(d,e)},used(d){let e=!1;return this.customizeDataList.forEach(a=>{a.newClaimNts&&a.newClaimNts.some(p=>{p.enName===d&&(e=!0)})}),e},productUsed(d){var a;let e=!1;return(a=this.myProductList)==null||a.forEach(p=>{var i;(i=p.newClaimNts)==null||i.some(s=>{s===d&&(e=!0)})}),e}}},te={class:"mx-auto col-11 col-lg-10 col-xl-9 col-xxl-8 pb-5 mb-5"},se={class:"text-end px-1"},de={class:"row"},le={key:0,class:"mx-auto py-5 col-12 w-100 text-center"},oe={class:"text-center fw-bold fs-5 text-primary"},ie={class:"card bg-light"},ae={class:"card-text mb-0 fw-bold"},ne={class:"fw-normal"},re={class:"card-text mb-0 fw-bold"},me={class:"fw-normal"},ue={class:"card-text mb-0 fw-bold"},ce={class:"fw-normal"},he={class:"card-text mb-0 fw-bold"},fe={class:"fw-normal"},pe={class:"text-end"},be=["onClick","disabled"],Ne=["onClick","disabled"],ye={key:0,class:"py-1 text-secondary d-flex flex-wrap justify-content-end"},ge={key:0},ke={key:1},ve={key:2};function xe(d,e,a,p,i,s){const l=k("NewClaimNtsModal"),C=k("DoubleCheckModal");return n(),r("div",te,[t("header",se,[e[2]||(e[2]=t("h3",{class:"text-center"},"已新增的營養素",-1)),d.myAddedNtsList.length>0?(n(),r("button",{key:0,onClick:e[0]||(e[0]=(...o)=>s.openAddNtsModal&&s.openAddNtsModal(...o)),type:"button",class:"btn btn-primary mb-3"}," 新增 ")):h("",!0)]),t("div",de,[d.myAddedNtsList.length===0?(n(),r("section",le,[e[3]||(e[3]=t("i",{class:"bi bi-card-text text-secondary"},null,-1)),t("p",oe,f(s.noResultText),1),t("button",{onClick:e[1]||(e[1]=(...o)=>s.openAddNtsModal&&s.openAddNtsModal(...o)),class:"btn btn-primary"}," 試著新增一個吧！ ")])):h("",!0),(n(!0),r(U,null,V(d.myAddedNtsList,(o,N)=>(n(),r("section",{key:o,class:"col-md-6 mb-3"},[t("div",ie,[t("div",{class:D(["card-body d-flex flex-column justify-content-between",s.used(o.enName)||s.productUsed(o.enName)?"pb-2":""])},[t("div",null,[t("p",ae,[e[4]||(e[4]=u(" 英文名稱： ")),t("span",ne,f(o.enName),1)]),t("p",re,[e[5]||(e[5]=u(" 中文名稱： ")),t("span",me,f(o.chName),1)]),t("p",ue,[e[6]||(e[6]=u(" 單位： ")),t("span",ce,f(o.unit),1)]),t("p",he,[e[7]||(e[7]=u(" 類別： ")),t("span",fe,f(o.type),1)])]),t("div",pe,[t("button",{onClick:A=>s.openEditModal(N,o),disabled:s.used(o.enName)||s.productUsed(o.enName),class:"btn btn-outline-primary me-2"}," 編輯 ",8,be),t("button",{onClick:A=>s.openDoubleCheckModal(N,o),disabled:s.used(o.enName)||s.productUsed(o.enName),class:"btn btn-outline-danger"}," 刪除 ",8,Ne),s.used(o.enName)||s.productUsed(o.enName)?(n(),r("div",ye,[e[8]||(e[8]=t("i",{class:"bi bi-info-circle pe-1"},null,-1)),s.used(o.enName)?(n(),r("span",ge,"自定義資料")):h("",!0),s.used(o.enName)&&s.productUsed(o.enName)?(n(),r("span",ke," 及 ")):h("",!0),s.productUsed(o.enName)?(n(),r("span",ve,"產品營養標示")):h("",!0),e[9]||(e[9]=t("span",null,"已使用，不予編輯及刪除",-1))])):h("",!0)])],2)])]))),128))]),g(l,{ref:"newClaimNtsModal"},null,512),g(C,{ref:"doubleCheckModal"},null,512)])}const Le=v(ee,[["render",xe],["__scopeId","data-v-b3c6f38f"]]);export{Le as default};
