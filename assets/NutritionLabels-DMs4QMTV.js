import{u as x,a as F,b as S}from"./component-functions-C1boh6Xt.js";import{_ as z,o as l,c as i,a as e,i as w,f as d,g as _,m as k,t as u,n as g,F as y,h as v,B as E,d as h,z as c,C as p,D,b as B,r as C}from"./index-p188OfOp.js";import{C as A}from"./CustomizeBaseDataModal-BjH0GTDN.js";import{M as N}from"./DoubleCheckModal-D03_2ovZ.js";import"./selector-engine-BAtv4zJi.js";const M="/nutrition_label_tool/assets/%E7%87%9F%E9%A4%8A%E6%A8%99%E7%A4%BA-%E6%AF%8F%E4%B8%80%E4%BB%BD%E9%87%8F-BJDXuoBc.png",q="/nutrition_label_tool/assets/%E7%87%9F%E9%A4%8A%E6%A8%99%E7%A4%BA-%E5%90%AB%E5%B9%BE%E4%BB%BD-CbXbq5wp.png",j="/nutrition_label_tool/assets/ingredient-2-D1x0ESuD.png",U="/nutrition_label_tool/assets/ingredient-1-BZuXPh4b.png",P={data(){return{modal:{},imgName:"營養標示-每一份量.png",perServing:M,howMany:q,currentImg:M,currentView:""}},methods:{showModal(o){o==="perServing"&&(this.currentImg=this.perServing,this.currentView="showImg"),o==="howMany"&&(this.currentImg=this.howMany,this.currentView="showImg"),o==="productQty"&&(this.currentImg="",this.currentView=o),o==="totalWeight"&&(this.currentImg="",this.currentView=o),this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new N(this.$refs.instructionModal)}},L={ref:"instructionModal",class:"modal fade",tabindex:"-1"},T={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable justify-content-center"},W={key:0,class:"modal-content"},Q=["src","alt"],H={key:2,class:"modal-content"};function O(o,t,n,m,r,a){return l(),i("div",L,[e("div",T,[r.currentView==="productQty"?(l(),i("div",W,t[0]||(t[0]=[w('<div class="modal-header bg-primary" data-v-fb66fdaf><h5 class="modal-title text-white" data-v-fb66fdaf>說明共可製成幾份</h5></div><div class="modal-body" data-v-fb66fdaf><p data-v-fb66fdaf> 例 1：總共有以下食材：娃娃菜、洋蔥、鴻喜菇、干貝...等，煮完可以分成 7 份。 </p><p data-v-fb66fdaf>因此這裡的欄位填入 <span class="fw-bold text-primary" data-v-fb66fdaf>7 </span></p><hr data-v-fb66fdaf><p data-v-fb66fdaf> 例 2：食材總量是 200 公克的白飯，我的成品每一份是 200 公克，所以 200 公克的白飯共可製成 1 份成品。 </p><p data-v-fb66fdaf> 因此這裡的欄位會填入 <span class="fw-bold text-primary" data-v-fb66fdaf>1</span></p></div><div class="modal-footer bg-light" data-v-fb66fdaf><button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-v-fb66fdaf> 關閉 </button></div>',3)]))):d("",!0),r.currentView==="showImg"?(l(),i("img",{key:1,src:r.currentImg,alt:r.imgName,class:"showImg"},null,8,Q)):d("",!0),r.currentView==="totalWeight"?(l(),i("div",H,t[1]||(t[1]=[w('<div class="modal-header bg-primary" data-v-fb66fdaf><h5 class="modal-title text-white" data-v-fb66fdaf>說明 外包裝成分 及 總克數 欄位</h5></div><div class="modal-body" data-v-fb66fdaf><p class="fw-bold fs-5 ps-2 mb-3" data-v-fb66fdaf> 舉例，總共食材：娃娃菜 238 公克、洋蔥 172 公克、鴻喜菇 136 公克、干貝 20 公克...等，將用來製成 7 份的成品。 </p><p class="fw-bold fs-5 ps-2 mb-3" data-v-fb66fdaf> 以下欄位需填入這 7 份各食材所用的總克數。 </p><img class="ingredientImg mb-5 border" src="'+j+'" alt="ingredientImg" data-v-fb66fdaf><p class="fw-bold fs-5 ps-2 mb-3" data-v-fb66fdaf>2. 外包裝成分呈現範例</p><img class="ingredientImg border" src="'+U+'" alt="ingredientImg" data-v-fb66fdaf></div><div class="modal-footer bg-light" data-v-fb66fdaf><button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-v-fb66fdaf> 關閉 </button></div>',3)]))):d("",!0)])],512)}const X=z(P,[["render",O],["__scopeId","data-v-fb66fdaf"]]),J={data(){return{filteredData:[],alert:!1,filteredCustomizeData:[],isBuiltIn:!0,isCustomize:!1,showDataBase:!0}},components:{CustomizeBaseDataModal:A,InstructionModal:X},watch:{customizeModal:{handler(o){o.switch===!1&&this.$route.path==="/nutrition_label"&&(this.showCustomizeDataBase(),this.searchFood(o.title),document.getElementById("searchInput").value=o.title)},deep:!0,immediate:!0}},computed:{..._(x,["baseFoodData","product"]),..._(F,["customizeDataList","customizeModal"]),toggleBtnText(){return this.showDataBase===!0?"隱藏資料庫":"開啟資料庫"},titleText(){return this.product.id?"編輯營養標示":"營養標示製作"}},methods:{...k(S,["openAlert"]),...k(x,["showChosenMsg"]),toggleDataBase(){this.showDataBase=!this.showDataBase},showBuiltInDataBase(){this.isBuiltIn=!0,this.isCustomize=!1},showCustomizeDataBase(){this.isCustomize=!0,this.isBuiltIn=!1},searchFood(o){const t=[];this.baseFoodData.filter(m=>{(m.sample_name&&m.sample_name.match(o)||m.common_name&&m.common_name.match(o))&&t.push(m)}),this.filteredData=t;const n=[];this.customizeDataList.filter(m=>{m.sample_name&&m.sample_name.match(o)&&n.push(m)}),this.filteredCustomizeData=n,this.filteredData.length===0&&this.filteredCustomizeData.length!==0&&this.showCustomizeDataBase(),this.filteredData.length!==0&&this.filteredCustomizeData.length===0&&this.showBuiltInDataBase()},chooseSample(o){if(this.product.ingredients.some(n=>n.sample_name===o.sample_name&&n.common_name===o.common_name))this.openAlert(!0,"已經選取囉！");else{this.addNewField();const n=this.product.ingredients.find(m=>m.sample_name==="");n&&(n.id=Date.now(),n.details=o,n.sample_name=o.sample_name,o.common_name&&(n.common_name=o.common_name),n.details.category==="自定義"&&(o.sample_name===o.content_description?n.foodName=o.sample_name:n.foodName=o.sample_name+" ( "+o.content_description+" ) "),this.showChosenMsg(o.sample_name))}},addNewField(){const o={id:"",sample_name:"",foodName:"",grams:"",details:""};this.product.ingredients.push(o)},delField(o){const t=this.product.ingredients.indexOf(o);this.product.ingredients.splice(t,1)},submitForm(o){this.product.ingredients.filter(n=>{n.sample_name===""&&this.delField(n)});const t=o.target;if(!t.checkValidity()){t.classList.add("was-validated"),this.openAlert(!0,"還有必填欄位喔！");return}this.product.id?this.$router.push(`/edit_mark_items/${this.product.id}`):this.$router.push("/mark_items")},getAllData(){this.filteredData=this.baseFoodData,this.filteredCustomizeData=this.customizeDataList},openCustomizeBaseDataModal(){this.$refs.customizeBaseDataModal.showModal()},openInstructionModal(o){this.$refs.instructionModal.showModal(o)}},created(){this.getAllData()}},R={class:"mx-auto col-11 col-xxl-10 pb-5 mb-5"},Z={class:"text-center mb-4"},G={class:"text-end mb-2 me-1 d-block d-xl-none"},K={key:0,class:"form-floating mb-5 mx-1"},Y={class:"col-12 ps-1"},$={class:"row col-12 mx-0 mb-5"},tt={key:0,class:"dataWrap bg-light py-2 mb-3 me-2 border rounded-3 col-12 col-xl-3"},et={class:"d-flex flex-wrap justify-content-center mb-2"},st={key:0,class:"py-5 text-center"},ot={key:1},lt=["onClick"],it={class:"mb-0 px-2"},at={key:0,class:"mb-0 px-2 text-secondary"},nt={key:1,class:"mb-0 px-2 text-secondary"},rt={key:0,class:"mt-5 text-center"},dt=["onClick"],mt={class:"mb-0 px-2"},ut={key:0,class:"mb-0 px-2 text-secondary"},ct={key:0,class:"mt-5 text-center"},pt={class:"col-12 col-xl-6 mb-3"},ft={class:"col-12 col-xl-6 mb-3"},bt={for:"number_of_copies",class:"form-label fw-bold d-flex flex-wrap justify-content-start"},gt={class:"pe-1"},ht={class:"col-12 col-xl-6 d-flex mb-3"},yt={class:"col-12"},vt={for:"net_weight",class:"form-label fw-bold d-flex flex-wrap justify-content-start col-12"},xt={class:"infoStyle text-secondary fw-normal d-flex flex-wrap align-items-center"},wt={class:"bi bi-info-circle fst-normal"},_t={class:"col-12 d-flex flex-wrap justify-content-between"},kt={class:"col-12 col-xl-6"},Dt={class:"mt-2 col-12 col-xl-5 text-xl-center"},Bt={class:"form-check form-check-inline"},Ct={class:"form-check form-check-inline"},Mt={class:"col-12 col-xl-6 mb-3"},zt={for:"product_quantity",class:"form-label fw-bold d-flex flex-wrap justify-content-start"},It={class:"infoStyle text-secondary fw-normal d-flex flex-wrap align-items-center"},Vt={class:"bi bi-info-circle me-2 fst-normal"},Ft={class:"col-12"},St={class:"mb-0 py-2 fw-bold"},Et={key:0,class:"px-1 bg-primary50 list-group-item col-12 col-xl-3 d-flex"},At={class:"pe-1 fst-normal"},Nt={class:"mb-0"},qt={key:0,class:"mb-0"},jt={key:1,class:"px-0 bg-primary50 list-group-item col-12 col-xl-4 d-flex flex-column justify-content-center"},Ut=["onUpdate:modelValue","id","disabled"],Pt={key:2,class:"px-0 bg-primary50 bg-opacity-50 list-group-item col-12 col-xl-3 d-flex flex-column justify-content-center"},Lt=["onUpdate:modelValue","id"],Tt={key:3,class:"bg-primary50 d-none d-xl-block list-group-item col-1 align-content-center"},Wt=["onClick"],Qt={key:4,class:"bg-primary50 d-block d-xl-none position-absolute delBtn-xs list-group"},Ht=["onClick"];function Ot(o,t,n,m,r,a){const I=C("CustomizeBaseDataModal"),V=C("InstructionModal");return l(),i("main",R,[e("h3",Z,u(a.titleText),1),e("div",G,[e("button",{onClick:t[0]||(t[0]=(...s)=>a.toggleDataBase&&a.toggleDataBase(...s)),class:"btn btn-primary",type:"button"},u(a.toggleBtnText),1)]),r.showDataBase?(l(),i("section",K,[e("input",{onInput:t[1]||(t[1]=s=>a.searchFood(s.target.value.trim())),type:"search",class:"form-control",id:"searchInput",placeholder:"請輸入食物成分搜尋"},null,32),t[18]||(t[18]=e("label",{for:"searchInput"},"請輸入食物名稱搜尋",-1))])):d("",!0),e("div",Y,[e("div",$,[r.showDataBase?(l(),i("section",tt,[e("div",et,[e("button",{onClick:t[2]||(t[2]=(...s)=>a.showBuiltInDataBase&&a.showBuiltInDataBase(...s)),type:"button",class:g(["col-12 col-md m-1 me-1 btn btn-sm",r.isBuiltIn?"btn-primary":"btn-outline-primary"])}," 內建資料庫 ",2),e("button",{onClick:t[3]||(t[3]=(...s)=>a.showCustomizeDataBase&&a.showCustomizeDataBase(...s)),type:"button",class:g(["col-12 col-md m-1 me-1 btn btn-sm",r.isCustomize?"btn-primary":"btn-outline-primary"])}," 自定義資料庫 ",2)]),e("section",null,[r.filteredData.length===0&&r.filteredCustomizeData.length===0?(l(),i("div",st,[t[19]||(t[19]=e("p",{class:"mb-2 fw-bold px-3"},"皆無相符品項",-1)),t[20]||(t[20]=e("p",{class:"px-3"},"若該品項有營養標示，可自行新增資料",-1)),e("button",{onClick:t[4]||(t[4]=(...s)=>a.openCustomizeBaseDataModal&&a.openCustomizeBaseDataModal(...s)),type:"button",class:"btn btn-sm btn-outline-primary"}," 新增自定義資料 ")])):(l(),i("div",ot,[r.isBuiltIn?(l(),i("section",{key:0,class:g(["list-group rounded overflow-y-auto overflow-x-hidden",["xsVisibleHeight","visibleHeight"]])},[(l(!0),i(y,null,v(r.filteredData,s=>(l(),i("button",{key:s.id,onClick:f=>a.chooseSample(s),type:"button",class:"list-group-item list-group-item-action px-1","aria-current":"true"},[e("p",it,u(s.sample_name),1),s.common_name?(l(),i("p",at," 俗名:"+u(s.common_name),1)):d("",!0),s.content_description?(l(),i("p",nt,u(s.content_description),1)):d("",!0)],8,lt))),128)),r.filteredData.length===0?(l(),i("div",rt,[t[21]||(t[21]=e("p",{class:"mb-0 text-center fw-bold"},"內建資料庫中",-1)),t[22]||(t[22]=e("p",{class:"mb-0 text-center fw-bold"},"無相符品項",-1)),t[23]||(t[23]=e("p",{class:"px-3"},"若該品項有營養標示，可自行新增資料",-1)),e("button",{onClick:t[5]||(t[5]=(...s)=>a.openCustomizeBaseDataModal&&a.openCustomizeBaseDataModal(...s)),type:"button",class:"btn btn-sm btn-outline-primary"}," 新增自定義資料 ")])):d("",!0)])):d("",!0),r.isCustomize?(l(),i("section",{key:1,class:g(["list-group rounded overflow-y-auto overflow-x-hidden",["xsVisibleHeight","visibleHeight"]])},[(l(!0),i(y,null,v(r.filteredCustomizeData,s=>(l(),i("button",{key:s.id,onClick:f=>a.chooseSample(s),type:"button",class:"list-group-item list-group-item-action px-1","aria-current":"true"},[e("p",mt,u(s.sample_name),1),s.common_name?(l(),i("p",ut," 俗名："+u(s.common_name),1)):d("",!0)],8,dt))),128)),r.filteredCustomizeData.length===0?(l(),i("div",ct,[t[24]||(t[24]=e("p",{class:"mb-0 text-center fw-bold"},"自定義資料庫中",-1)),t[25]||(t[25]=e("p",{class:"mb-2 text-center fw-bold"},"無相符品項",-1)),t[26]||(t[26]=e("p",{class:"px-3"},"若該品項有營養標示，可自行新增資料",-1)),e("button",{onClick:t[6]||(t[6]=(...s)=>a.openCustomizeBaseDataModal&&a.openCustomizeBaseDataModal(...s)),type:"button",class:"btn btn-sm btn-outline-primary"}," 新增自定義資料 ")])):d("",!0)])):d("",!0)]))])])):d("",!0),e("form",{id:"form_id",onSubmit:t[17]||(t[17]=E((...s)=>a.submitForm&&a.submitForm(...s),["prevent"])),class:"row mx-0 pt-3 pe-1 bg-primary50 rounded-3 align-content-start col-12 col-xl border",novalidate:""},[e("section",pt,[t[27]||(t[27]=e("label",{for:"productName",class:"form-label fw-bold d-flex justify-content-start"},[e("div",{class:"pe-1 d-flex align-items-center"},[e("i",{class:"text-danger fst-normal"},"＊")]),h(" 商品名稱 ")],-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.product.title=s),type:"text",class:"form-control",id:"productName",placeholder:"請輸入商品名稱",required:""},null,512),[[p,o.product.title,void 0,{trim:!0}]]),t[28]||(t[28]=e("div",{class:"invalid-feedback"},"此欄位為必填",-1))]),e("section",ft,[e("label",bt,[e("div",gt,[t[29]||(t[29]=e("i",{class:"text-danger fst-normal pe-1"},"＊",-1)),t[30]||(t[30]=e("span",{class:"me-1"},"以下食材總量共可製成幾份成品？",-1)),e("i",{onClick:t[8]||(t[8]=s=>a.openInstructionModal("productQty")),class:"showInfo bi bi-question-circle text-primary fw-normal fst-normal infoStyle d-inline-block"}," 說明 ")])]),c(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.product.numberOfCopy=s),type:"number",min:"1",step:"0.1",class:"form-control",id:"number_of_copies",placeholder:"輸入共可製成幾份成品",required:""},null,512),[[p,o.product.numberOfCopy]]),t[31]||(t[31]=e("div",{class:"invalid-feedback"},"此欄位為必填，且需大於等於 1",-1))]),e("section",ht,[e("div",yt,[e("label",vt,[t[33]||(t[33]=e("div",{class:"pe-1 d-flex align-items-center"},[e("i",{class:"text-danger fst-normal"},"＊")],-1)),t[34]||(t[34]=e("span",{class:"me-2"},"每一份量",-1)),e("div",xt,[e("i",wt,[t[32]||(t[32]=h(" 將顯示在每一份量的位置 ")),e("i",{onClick:t[10]||(t[10]=s=>a.openInstructionModal("perServing")),class:"showInfo bi bi-question-circle fst-normal text-primary d-inline-block"}," 顯示圖示 ")])])]),e("div",_t,[e("div",kt,[c(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>o.product.perPortionInfomation.perWeight=s),type:"number",min:"1",class:"form-control me-3",id:"net_weight",placeholder:"輸入克數或毫升數",required:""},null,512),[[p,o.product.perPortionInfomation.perWeight]]),t[35]||(t[35]=e("div",{class:"invalid-feedback"}," 此欄位為必填，且需大於等於 1 ",-1))]),e("div",Dt,[e("div",Bt,[c(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>o.product.perPortionInfomation.unit=s),class:"form-check-input",type:"radio",id:"gram",value:"公克"},null,512),[[D,o.product.perPortionInfomation.unit]]),t[36]||(t[36]=e("label",{class:"form-check-label",for:"gram"},"公克",-1))]),e("div",Ct,[c(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>o.product.perPortionInfomation.unit=s),class:"form-check-input",type:"radio",id:"milliliter",value:"毫升"},null,512),[[D,o.product.perPortionInfomation.unit]]),t[37]||(t[37]=e("label",{class:"form-check-label",for:"milliliter"}," 毫升 ",-1))])])])])]),e("section",Mt,[e("label",zt,[t[39]||(t[39]=e("div",{class:"pe-1 d-flex align-items-center"},[e("i",{class:"text-danger fst-normal"},[h(" ＊ "),e("span",{class:"me-1 text-dark"},"本包裝含幾份成品？")])],-1)),e("div",It,[e("i",Vt,[t[38]||(t[38]=h(" 將顯示在本包裝含幾份的位置 ")),e("i",{onClick:t[14]||(t[14]=s=>a.openInstructionModal("howMany")),class:"showInfo bi bi-question-circle fst-normal text-primary d-inline-block"}," 顯示圖示 ")])])]),c(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>o.product.productQty=s),type:"number",min:"1",step:"0.1",class:"form-control",id:"product_quantity",placeholder:"輸入本包裝含幾份成品",required:""},null,512),[[p,o.product.productQty]]),t[40]||(t[40]=e("div",{class:"invalid-feedback"},"此欄位為必填，且需大於等於 1",-1))]),e("section",Ft,[e("p",St,[t[41]||(t[41]=e("span",{class:"text-danger"},"＊",-1)),t[42]||(t[42]=h(" 先從資料庫點選成分，再填入各欄位所需資料 ")),e("i",{onClick:t[16]||(t[16]=s=>a.openInstructionModal("totalWeight")),class:"showInfo bi bi-question-circle text-primary fw-normal fst-normal ps-1 infoStyle d-inline-block"}," 說明 ")]),(l(!0),i(y,null,v(o.product.ingredients,(s,f)=>(l(),i("ul",{key:s.id,class:g(["rounded-0 position-relative col-12 list-group list-group-horizontal-xl d-flex flex-wrap justify-content-between",s.sample_name===""?"":"border-top"])},[s.sample_name?(l(),i("li",Et,[e("i",At,u(f+1)+".",1),e("div",null,[e("p",Nt,u(s.sample_name),1),s.common_name?(l(),i("p",qt," 俗名:"+u(s.common_name),1)):d("",!0)])])):d("",!0),s.sample_name?(l(),i("li",jt,[c(e("input",{"onUpdate:modelValue":b=>s.foodName=b,type:"text",id:"foodName"+f,disabled:s.details.category==="自定義",placeholder:"輸入欲示於外包裝成分",class:"form-control",required:""},null,8,Ut),[[p,s.foodName,void 0,{trim:!0}]]),t[43]||(t[43]=e("div",{class:"invalid-feedback"},"此欄位為必填",-1))])):d("",!0),s.sample_name?(l(),i("li",Pt,[c(e("input",{"onUpdate:modelValue":b=>s.grams=b,type:"number",id:"grams"+f,min:"0.1",step:"0.1",placeholder:"輸入該成分『 總克數 』",class:"form-control",required:""},null,8,Lt),[[p,s.grams]]),t[44]||(t[44]=e("div",{class:"invalid-feedback"},"此欄位為必填，且需大於 0",-1))])):d("",!0),s.sample_name?(l(),i("li",Tt,[e("button",{onClick:b=>a.delField(s),type:"button",class:"btn btn-outline-danger btn-sm d-block"},t[45]||(t[45]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Wt)])):d("",!0),s.sample_name?(l(),i("li",Qt,[e("button",{onClick:b=>a.delField(s),type:"button",class:"btn btn-outline-danger btn-sm"},t[46]||(t[46]=[e("i",{class:"bi bi-x-lg"},null,-1)]),8,Ht)])):d("",!0)],2))),128))])],32)]),t[47]||(t[47]=e("div",{class:"col-12 text-end mb-4"},[e("button",{form:"form_id",type:"submit",class:"col-12 col-xl-9 btn btn-primary"}," 送出以上資料 ")],-1))]),B(I,{ref:"customizeBaseDataModal"},null,512),B(V,{ref:"instructionModal"},null,512)])}const Kt=z(J,[["render",Ot],["__scopeId","data-v-d81678c9"]]);export{Kt as default};
